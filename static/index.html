<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basit EMA Cross Bot v1.0</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>

    <div id="login-container" class="container">
        <div class="card login-card">
            <h1>🎯 Basit EMA Cross Bot v1.0</h1>
            <p class="subtitle">EMA 9/21 Kesişim Stratejisi - Basit ve Güvenilir</p>
            <div class="form-group">
                <label for="email">E-posta</label>
                <input type="email" id="email" placeholder="ornek@mail.com" autocomplete="email">
            </div>
            <div class="form-group">
                <label for="password">Şifre</label>
                <input type="password" id="password" placeholder="••••••••" autocomplete="current-password">
            </div>
            <button id="login-button" class="btn btn-start">Giriş Yap</button>
            <p id="login-error" class="error-message"></p>
        </div>
    </div>

    <div id="app-container" class="container" style="display: none;">
        <header>
            <h1>🎯 Basit EMA Cross Bot</h1>
            <div class="header-info">
                <span class="badge">EMA 9/21</span>
                <span class="badge">Basit TP/SL</span>
            </div>
            <button id="logout-button" class="btn btn-logout">Çıkış Yap</button>
        </header>

        <main>
            <!-- STRATEJI BİLGİSİ -->
            <div class="card strategy-card">
                <h2>📈 Strateji Bilgisi</h2>
                <div class="strategy-info">
                    <div class="strategy-item">
                        <span class="strategy-icon">📈</span>
                        <div>
                            <div class="strategy-title">EMA Cross Sistemi</div>
                            <div class="strategy-desc">EMA 9 yukarı kesince LONG, aşağı kesince SHORT</div>
                        </div>
                    </div>
                    <div class="strategy-item">
                        <span class="strategy-icon">🎯</span>
                        <div>
                            <div class="strategy-title">Otomatik TP/SL</div>
                            <div class="strategy-desc">Her pozisyona otomatik kar al/zarar durdur</div>
                        </div>
                    </div>
                    <div class="strategy-item">
                        <span class="strategy-icon">⚡</span>
                        <div>
                            <div class="strategy-title">Basit ve Hızlı</div>
                            <div class="strategy-desc">Karmaşık filtre yok, sadece EMA kesişimi</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CÜZDAN DURUMU -->
            <div class="card status-card">
                <h2>💰 Cüzdan Durumu</h2>
                <div class="stats-grid">
                    <p class="stats-label">Ana Bakiye (USDT):</p>
                    <p class="stats-value" id="stats-main-balance">Yükleniyor...</p>
                    <p class="stats-label">Aktif Pozisyon P&L:</p>
                    <p class="stats-value" id="stats-position-pnl">Yükleniyor...</p>
                    <p class="stats-label">İşlem Miktarı (USDT):</p>
                    <p class="stats-value" id="stats-order-size">Yükleniyor...</p>
                </div>
            </div>

            <!-- BOT DURUMU -->
            <div class="card status-card">
                <h2>🤖 Bot Durumu</h2>
                <div class="status-grid">
                    <p class="status-label">Durum:</p>
                    <p class="status-value"><span id="status-message">Bot başlatılmadı.</span></p>
                    <p class="status-label">İzlenen Coinler:</p>
                    <p class="status-value"><span id="monitored-symbols">Hayır</span></p>
                    <p class="status-label">Aktif Pozisyon:</p>
                    <p class="status-value"><span id="active-position">Hayır</span></p>
                    <p class="status-label">WebSocket Bağlantıları:</p>
                    <p class="status-value"><span id="websocket-count">0</span></p>
                    <p class="status-label">Son Güncelleme:</p>
                    <p class="status-value"><span id="last-update">-</span></p>
                </div>
            </div>

            <!-- COİN YÖNETİMİ -->
            <div class="card controls-card">
                <h2>🎯 Multi-Coin Bot Yönetimi</h2>
                
                <div class="form-group">
                    <label for="multi-symbols-input">İzlenecek Coinler (maksimum 10)</label>
                    <input type="text" id="multi-symbols-input" placeholder="BTC, ETH, ADA, SOL, DOT" 
                           title="Virgülle ayırarak maksimum 10 coin girin">
                </div>
                
                <div class="button-group">
                    <button id="multi-start-button" class="btn btn-start">🚀 Multi-Coin Bot Başlat</button>
                    <button id="stop-button" class="btn btn-stop" disabled>🛑 Bot Durdur</button>
                    <button id="refresh-button" class="btn btn-info">🔄 Manuel Yenile</button>
                </div>

                <div class="strategy-settings">
                    <h3>⚙️ Strateji Ayarları</h3>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <span class="setting-label">EMA Hızlı:</span>
                            <span class="setting-value">9</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">EMA Yavaş:</span>
                            <span class="setting-value">21</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Timeframe:</span>
                            <span class="setting-value">15m</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Kaldıraç:</span>
                            <span class="setting-value">10x</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Stop Loss:</span>
                            <span class="setting-value">0.8%</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Take Profit:</span>
                            <span class="setting-value">1.5%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- İZLENEN COİNLER LİSTESİ -->
            <div class="card symbols-card" id="symbols-card" style="display: none;">
                <h2>📊 İzlenen Coinler & EMA Sinyalleri</h2>
                <div id="symbols-list" class="symbols-grid">
                    <!-- Dinamik olarak doldurulacak -->
                </div>
            </div>

            <!-- POZİSYON KORUMASI -->
            <div class="card controls-card">
                <h2>🛡️ Pozisyon Koruması</h2>
                <p class="subtitle">Açık pozisyonlar için otomatik TP/SL koruması</p>
                
                <div class="button-group">
                    <button id="scan-all-button" class="btn btn-info">🔍 Tüm Pozisyonları Tara</button>
                    <button id="monitor-toggle-button" class="btn btn-secondary">📊 TP/SL Monitor</button>
                </div>
                
                <div class="form-group">
                    <label for="scan-symbol-input">Coin Kontrolü</label>
                    <input type="text" id="scan-symbol-input" placeholder="Örn: BTCUSDT">
                </div>
                <button id="scan-symbol-button" class="btn btn-info">🎯 Coin Kontrol Et</button>
            </div>

            <!-- İSTATİSTİKLER -->
            <div class="card stats-card">
                <h2>📊 İşlem İstatistikleri</h2>
                <div class="stats-grid">
                    <p class="stats-label">Toplam İşlem:</p>
                    <p class="stats-value" id="stats-total-trades">0</p>
                    <p class="stats-label">Başarılı İşlem:</p>
                    <p class="stats-value" id="stats-winning-trades">0</p>
                    <p class="stats-label">Başarısız İşlem:</p>
                    <p class="stats-value" id="stats-losing-trades">0</p>
                    <p class="stats-label">Başarı Oranı:</p>
                    <p class="stats-value" id="stats-win-rate">-%</p>
                </div>
            </div>

            <!-- SINGLE COİN MODU -->
            <div class="card controls-card legacy-card">
                <h2>🔄 Tek Coin Modu</h2>
                <p class="subtitle">Geriye uyumluluk - tek coin ile bot başlat</p>
                <div class="form-group">
                    <label for="single-symbol-input">Tek Coin Sembolü</label>
                    <input type="text" id="single-symbol-input" placeholder="Örn: BTCUSDT">
                </div>
                <div class="button-group">
                    <button id="single-start-button" class="btn btn-secondary">🔄 Tek Coin Başlat</button>
                </div>
            </div>

        </main>
    </div>

    <!-- JavaScript -->
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-database.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Firebase config
            const firebaseConfig = {
                apiKey: "AIzaSyDkJch-8B46dpZSB-pMSR4q1uvzadCVekE",
                authDomain: "aviator-90c8b.firebaseapp.com",
                databaseURL: "https://aviator-90c8b-default-rtdb.firebaseio.com",
                projectId: "aviator-90c8b",
                storageBucket: "aviator-90c8b.appspot.com",
                messagingSenderId: "823763988442",
                appId: "1:823763988442:web:16a797275675a219c3dae3"
            };

            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const database = firebase.database();

            // HTML elementleri
            const loginContainer = document.getElementById('login-container');
            const appContainer = document.getElementById('app-container');
            const loginButton = document.getElementById('login-button');
            const logoutButton = document.getElementById('logout-button');
            const emailInput = document.getElementById('email');
            const passwordInput = document.getElementById('password');
            const loginError = document.getElementById('login-error');
            
            // Bot kontrolleri
            const multiSymbolsInput = document.getElementById('multi-symbols-input');
            const multiStartButton = document.getElementById('multi-start-button');
            const stopButton = document.getElementById('stop-button');
            const refreshButton = document.getElementById('refresh-button');
            const singleSymbolInput = document.getElementById('single-symbol-input');
            const singleStartButton = document.getElementById('single-start-button');
            
            // Status elementleri
            const statusMessageSpan = document.getElementById('status-message');
            const monitoredSymbolsSpan = document.getElementById('monitored-symbols');
            const activePositionSpan = document.getElementById('active-position');
            const websocketCountSpan = document.getElementById('websocket-count');
            const lastUpdateSpan = document.getElementById('last-update');
            const symbolsCard = document.getElementById('symbols-card');
            const symbolsList = document.getElementById('symbols-list');
            
            // Position management
            const scanAllButton = document.getElementById('scan-all-button');
            const monitorToggleButton = document.getElementById('monitor-toggle-button');
            const scanSymbolInput = document.getElementById('scan-symbol-input');
            const scanSymbolButton = document.getElementById('scan-symbol-button');
            
            // Stats
            const statsMainBalance = document.getElementById('stats-main-balance');
            const statsPositionPnl = document.getElementById('stats-position-pnl');
            const statsOrderSize = document.getElementById('stats-order-size');
            
            let statusInterval;
            let isMonitorRunning = false;

            // ⚡ API RATE SORUNU DÜZELTİLDİ
            // Eski: Her 8 saniyede bir istek (çok fazla!)
            // Yeni: Bot çalışırken 45 saniye, durmuşken 60 saniye
            const STATUS_UPDATE_INTERVALS = {
                BOT_RUNNING: 45000,      // Bot çalışırken 45 saniyede bir
                BOT_STOPPED: 60000       // Bot durakken 60 saniyede bir
            };

            // Kimlik doğrulama
            loginButton.addEventListener('click', () => {
                loginError.textContent = "";
                auth.signInWithEmailAndPassword(emailInput.value, passwordInput.value)
                    .catch(error => { loginError.textContent = "Hatalı e-posta veya şifre."; });
            });

            logoutButton.addEventListener('click', () => { auth.signOut(); });

            auth.onAuthStateChanged(user => {
                if (user) {
                    loginContainer.style.display = 'none';
                    appContainer.style.display = 'flex';
                    getStatus(); // İlk status al
                    startOptimizedStatusUpdates(); // Optimize edilmiş güncelleme başlat
                    listenForTradeUpdates();
                    updateMonitorButton();
                } else {
                    loginContainer.style.display = 'flex';
                    appContainer.style.display = 'none';
                    if (statusInterval) clearInterval(statusInterval);
                }
            });

            // API RATE SORUNU DÜZELTİLDİ - Dinamik interval
            function startOptimizedStatusUpdates() {
                if (statusInterval) clearInterval(statusInterval);
                
                const updateStatus = async () => {
                    await getStatus();
                    
                    // Bot durumuna göre dinamik interval
                    const currentStatus = await getCurrentBotStatus();
                    const interval = currentStatus.is_running ? 
                        STATUS_UPDATE_INTERVALS.BOT_RUNNING : 
                        STATUS_UPDATE_INTERVALS.BOT_STOPPED;
                    
                    // Sonraki güncellemeyi zamanla
                    if (statusInterval) clearTimeout(statusInterval);
                    statusInterval = setTimeout(updateStatus, interval);
                };
                
                updateStatus(); // İlk çalıştırma
            }

            async function getCurrentBotStatus() {
                try {
                    // Sadece bot durumunu kontrol etmek için lightweight bir check
                    // Eğer bu endpoint yoksa, mevcut status'tan al
                    return { is_running: statusMessageSpan.textContent.includes('izleniyor') };
                } catch (e) {
                    return { is_running: false };
                }
            }

            // API istekleri
            async function fetchApi(endpoint, options = {}) {
                const user = auth.currentUser;
                if (!user) return null;
                const idToken = await user.getIdToken(true);
                const headers = { ...options.headers, 'Authorization': `Bearer ${idToken}` };
                if (options.body) headers['Content-Type'] = 'application/json';
                try {
                    const response = await fetch(endpoint, { ...options, headers });
                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ detail: response.statusText }));
                        console.error("API Hatası:", errorData.detail);
                        showError(errorData.detail);
                        return null;
                    }
                    return response.json();
                } catch (error) { 
                    console.error("API isteği hatası:", error); 
                    showError("Bağlantı hatası: " + error.message);
                    return null; 
                }
            }

            function showError(message) {
                console.error("HATA:", message);
            }

            function showSuccess(message) {
                console.log("BAŞARILI:", message);
            }

            function updateLastUpdateTime() {
                const now = new Date();
                lastUpdateSpan.textContent = now.toLocaleTimeString('tr-TR');
            }
            
            // UI Güncelleme
            const updateUI = (data) => {
                if (!data) return;
                
                updateLastUpdateTime();
                
                // Durum mesajı
                statusMessageSpan.textContent = data.status_message || 'Bilinmiyor';
                statusMessageSpan.className = data.is_running ? 'status-running' : 'status-stopped';
                
                // İzlenen coinler
                if (data.symbols && data.symbols.length > 0) {
                    monitoredSymbolsSpan.textContent = `${data.symbols.length} coin (${data.symbols.join(', ')})`;
                    monitoredSymbolsSpan.className = 'status-monitoring';
                    
                    // Symbols card'ı göster ve güncelle
                    symbolsCard.style.display = 'block';
                    updateSymbolsList(data.symbols, data.last_signals, data.active_symbol);
                } else {
                    monitoredSymbolsSpan.textContent = 'Hayır';
                    monitoredSymbolsSpan.className = '';
                    symbolsCard.style.display = 'none';
                }
                
                // Aktif pozisyon
                if (data.active_symbol && data.position_side) {
                    activePositionSpan.textContent = `${data.position_side} @ ${data.active_symbol}`;
                    activePositionSpan.className = 'status-in-position';
                } else {
                    activePositionSpan.textContent = 'Hayır';
                    activePositionSpan.className = '';
                }
                
                // WebSocket bağlantıları
                websocketCountSpan.textContent = data.websocket_connections || 0;
                
                // Bot kontrolleri
                if (data.is_running) {
                    multiStartButton.disabled = true;
                    singleStartButton.disabled = true;
                    stopButton.disabled = false;
                    multiSymbolsInput.disabled = true;
                    singleSymbolInput.disabled = false;
                } else {
                    multiStartButton.disabled = false;
                    singleStartButton.disabled = false;
                    stopButton.disabled = true;
                    multiSymbolsInput.disabled = false;
                    singleSymbolInput.disabled = false;
                }
                
                // Finansal veriler
                if (data.is_running && data.account_balance !== undefined) {
                    formatPnl(statsMainBalance, data.account_balance, true);
                } else {
                    statsMainBalance.textContent = 'N/A';
                    statsMainBalance.className = 'stats-value';
                }

                if (data.is_running && data.position_pnl !== undefined) {
                    formatPnl(statsPositionPnl, data.position_pnl);
                } else {
                    statsPositionPnl.textContent = 'N/A';
                    statsPositionPnl.className = 'stats-value';
                }

                if (data.is_running && data.order_size !== undefined) {
                    statsOrderSize.textContent = `${data.order_size.toFixed(2)} USDT`;
                    statsOrderSize.className = 'stats-value';
                } else {
                    statsOrderSize.textContent = 'N/A';
                    statsOrderSize.className = 'stats-value';
                }
            };

            function updateSymbolsList(symbols, lastSignals, activeSymbol) {
                symbolsList.innerHTML = '';
                
                symbols.forEach(symbol => {
                    const symbolDiv = document.createElement('div');
                    symbolDiv.className = 'symbol-item';
                    if (symbol === activeSymbol) {
                        symbolDiv.classList.add('active-symbol');
                    }
                    
                    const signal = lastSignals ? lastSignals[symbol] || 'HOLD' : 'HOLD';
                    const signalClass = signal === 'LONG' ? 'signal-long' : 
                                       signal === 'SHORT' ? 'signal-short' : 'signal-hold';
                    
                    symbolDiv.innerHTML = `
                        <div class="symbol-name">${symbol}</div>
                        <div class="symbol-signal ${signalClass}">${signal}</div>
                    `;
                    
                    symbolsList.appendChild(symbolDiv);
                });
            }

            const getStatus = () => fetchApi('/api/multi-status').then(updateUI);

            // Manuel refresh butonu - rate limit sorunu çözmek için
            refreshButton.addEventListener('click', async () => {
                refreshButton.disabled = true;
                refreshButton.textContent = 'Yenileniyor...';
                
                await getStatus();
                
                refreshButton.disabled = false;
                refreshButton.textContent = '🔄 Manuel Yenile';
                showSuccess('Durum yenilendi');
            });

            // Event listeners (aynı)
            multiStartButton.addEventListener('click', async () => {
                const symbolsInput = multiSymbolsInput.value.trim();
                if (!symbolsInput) {
                    showError('Lütfen en az bir coin sembolü girin.');
                    return;
                }
                
                const symbols = symbolsInput.split(',')
                    .map(s => s.trim().toUpperCase())
                    .filter(s => s.length > 0);
                
                if (symbols.length === 0) {
                    showError('Geçerli coin sembolleri girin.');
                    return;
                }
                
                if (symbols.length > 10) {
                    showError('Maksimum 10 coin desteklenir.');
                    return;
                }
                
                console.log('Multi-coin bot başlatılıyor:', symbols);
                const result = await fetchApi('/api/multi-start', { 
                    method: 'POST', 
                    body: JSON.stringify({ symbols }) 
                });
                
                if (result) {
                    updateUI(result.status);
                    showSuccess(`${symbols.length} coin için bot başlatıldı`);
                    // Bot başlatıldığında status güncellemesini yeniden başlat
                    startOptimizedStatusUpdates();
                }
            });

            singleStartButton.addEventListener('click', async () => {
                const symbol = singleSymbolInput.value.trim().toUpperCase();
                if (!symbol) {
                    showError('Lütfen bir coin sembolü girin.');
                    return;
                }
                
                console.log('Tek coin bot başlatılıyor:', symbol);
                const result = await fetchApi('/api/start', { 
                    method: 'POST', 
                    body: JSON.stringify({ symbol }) 
                });
                
                if (result) {
                    // Convert to multi format
                    const multiResult = {
                        is_running: result.is_running,
                        symbols: result.symbol ? [result.symbol] : [],
                        active_symbol: result.symbol,
                        position_side: result.position_side,
                        status_message: result.status_message,
                        account_balance: result.account_balance,
                        position_pnl: result.position_pnl,
                        order_size: result.order_size,
                        last_signals: {},
                        websocket_connections: 1
                    };
                    updateUI(multiResult);
                    showSuccess(`Tek coin modu: ${symbol} başlatıldı`);
                    startOptimizedStatusUpdates();
                }
            });

            stopButton.addEventListener('click', async () => {
                const result = await fetchApi('/api/stop', { method: 'POST' });
                if (result) {
                    updateUI(result);
                    showSuccess('Bot durduruldu');
                    // Bot durdurulduğunda güncelleme sıklığını azalt
                    startOptimizedStatusUpdates();
                }
            });

            // Position management (aynı)
            scanAllButton.addEventListener('click', async () => {
                scanAllButton.disabled = true;
                scanAllButton.textContent = 'Taranıyor...';
                
                const result = await fetchApi('/api/scan-all-positions', { method: 'POST' });
                
                scanAllButton.disabled = false;
                scanAllButton.textContent = '🔍 Tüm Pozisyonları Tara';
                
                if (result && result.success) {
                    showSuccess(result.message);
                }
            });

            monitorToggleButton.addEventListener('click', async () => {
                if (isMonitorRunning) {
                    const result = await fetchApi('/api/stop-position-monitor', { method: 'POST' });
                    if (result && result.success) {
                        showSuccess(result.message);
                        updateMonitorButton();
                    }
                } else {
                    const result = await fetchApi('/api/start-position-monitor', { method: 'POST' });
                    if (result && result.success) {
                        showSuccess(result.message);
                        updateMonitorButton();
                    }
                }
            });

            scanSymbolButton.addEventListener('click', async () => {
                const symbol = scanSymbolInput.value.trim().toUpperCase();
                if (!symbol) {
                    showError('Lütfen bir coin sembolü girin.');
                    return;
                }
                
                scanSymbolButton.disabled = true;
                scanSymbolButton.textContent = 'Kontrol Ediliyor...';
                
                const result = await fetchApi('/api/scan-symbol', { 
                    method: 'POST', 
                    body: JSON.stringify({ symbol }) 
                });
                
                scanSymbolButton.disabled = false;
                scanSymbolButton.textContent = '🎯 Coin Kontrol Et';
                
                if (result && result.success) {
                    scanSymbolInput.value = '';
                    showSuccess(result.message);
                }
            });

            async function updateMonitorButton() {
                const status = await fetchApi('/api/position-monitor-status');
                if (status && status.monitor_status) {
                    isMonitorRunning = status.monitor_status.is_running;
                    monitorToggleButton.textContent = isMonitorRunning ? 'Monitor Durdur' : 'Monitor Başlat';
                    monitorToggleButton.className = isMonitorRunning ? 'btn btn-warning' : 'btn btn-secondary';
                }
            }

            function formatPnl(element, value, isBalance = false) {
                element.textContent = `${value.toFixed(2)} USDT`;
                if (isBalance) {
                    element.className = 'stats-value';
                } else {
                    element.className = value > 0 ? 'stats-value pnl-positive' : 
                                     (value < 0 ? 'stats-value pnl-negative' : 'stats-value');
                }
            }

            function listenForTradeUpdates() {
                const tradesRef = database.ref('trades');
                tradesRef.on('value', (snapshot) => {
                    const trades = snapshot.val() ? Object.values(snapshot.val()) : [];
                    calculateAndDisplayStats(trades);
                });
            }

            function calculateAndDisplayStats(trades) {
                let totalTrades = trades.length;
                let winningTrades = 0, losingTrades = 0;

                trades.forEach(trade => {
                    const pnl = parseFloat(trade.pnl) || 0;
                    if (pnl > 0) {
                        winningTrades++;
                    } else {
                        losingTrades++;
                    }
                });

                const statsTotal = document.getElementById('stats-total-trades');
                const statsWinning = document.getElementById('stats-winning-trades');
                const statsLosing = document.getElementById('stats-losing-trades');
                const statsWinRate = document.getElementById('stats-win-rate');

                if (statsTotal) statsTotal.textContent = totalTrades;
                if (statsWinning) statsWinning.textContent = winningTrades;
                if (statsLosing) statsLosing.textContent = losingTrades;
                
                if (statsWinRate) {
                    const winRate = totalTrades > 0 ? ((winningTrades / totalTrades) * 100).toFixed(1) : 0;
                    statsWinRate.textContent = `%${winRate}`;
                }
            }

            // Klavye kısayolları
            multiSymbolsInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') multiStartButton.click();
            });

            singleSymbolInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') singleStartButton.click();
            });

            scanSymbolInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') scanSymbolButton.click();
            });
        });
    </script>
</body>
</html>
